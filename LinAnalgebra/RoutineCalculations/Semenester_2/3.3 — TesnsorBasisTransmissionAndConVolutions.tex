\documentclass[12pt, a4paper]{article}
\input{../../../LatexGloves/latex_math_header.tex}

\usepackage{geometry}
\geometry{
    a4paper,
    left=30mm,
    right=30mm,
    top=30mm,
    bottom=20mm
}

\newcommand\arr[2]{\left(\begin{array}{#1}#2\end{array}\right)}


\author{Латыпов Владимир Витальевич, \\ ИТМО КТ M3138, \Huge{\textit{\textbf{вариант 10}}}}
\title{Типовик по линейной алгебре 3, Задание 3 «Тензоры в линейном пространстве. Преобразование координат.»}

\begin{document}
    \tit

    \section{Формулировка условия}

    \begin{statement}
        Тензор $\alpha^{ij}_{kl} \in T_{(2, 2)}$ 
        задан четырехмерной матрицей второго порядка $A = \alpha^{ij}_{kl}$. 
        Задана матрица перехода $T$ от старого базиса $\{e_i\}_{i = 1}^2$
        к новому базису $\{\tilde{e_i}\}_{i = 1}^2$

        \begin{itemize}
            \item Вычислить элемент $\tilde{\alpha}^{ij}_{kl}$ матрицы тензора в новом базисе    
            \item Вычислить следующие свертки тензора (в старом базисе): \\
            $\alpha^{ij}_{ki}, \alpha^{ij}_{kj}, \alpha^{ij}_{ij}, \alpha^{ij}_{ji}$.
        \end{itemize}

        Data section:

        \begin{equation}
            T = \begin{pmatrix}
                2 & -1 \\
                -1 & 2
            \end{pmatrix}
        \end{equation}

        \begin{equation}
            A=\left\|\begin{array}{ll|ll}
                -1 & -3 & -4 & -1 \\
                5 & 2 & 4 & 6 \\
                \hline 
                0 & -2 & 1 & 0 \\
                1 & 1 & 0 & 2
            \end{array}\right\|
         \end{equation}
    \end{statement}

    \section{Вычисление элемента матрицы}
    
    Как известнго из формулы перехода матрицы тензора к новому базису, 

    \begin{equation}
        {\tilde{\alpha}}^{m_1\cdots m_q}_{k_1\cdots k_p}=\alpha^{i_1\cdots i_q}_{j_1\cdots j_p}t_{k_1}^{j_1}t_{k_2}^{j_2}\cdots t_{k_p}^{j_p}s_{i_1}^{m_1}s_{i_2}^{m_2}\cdots s_{i_q}^{m_q}
    \end{equation}

    В нашем случае:

    \begin{equation}
        \tilde{\alpha}_{12}^{21}=\sigma_{k}^{2} \sigma_{l}^{1} \tau_{1}^{m} \tau_{2}^{n} \alpha_{m n}^{k l}
    \end{equation}

    , где $\sigma$ — элементы матрицы $S$, а $\tau$ — матрицы $T$.

    \begin{equation}
        S = T^{-1} = \left(\begin{matrix}
            \frac{2}{3} & \frac{1}{3} \\
            \frac{1}{3} & \frac{2}{3}
        \end{matrix}\right) = \frac{1}{3} \left(\begin{matrix}
            2 & 1 \\
            1 & 2
        \end{matrix}\right)
    \end{equation}

    Переставим суммы и вычислим промежуточно матрицу $B$ тензора $b_{mn} = \sigma_{k}^{2} \sigma_{l}^{1} \alpha_{m n}^{k l}$.
    Матрица станет разменрности $2 \times 2$. Причём так как и для $\sigma_{k}^{2}$, и для $\sigma_{l}^{1}$ зафиксирован номер строки, можно получить нужное значение
    
    \begin{equation}
        B_{mn} = 
        \begin{pmatrix} \frac{1}{3} & \frac{2}{3} \end{pmatrix} A_{mn} \begin{pmatrix} \frac{2}{3} \\ \frac{1}{3} \end{pmatrix} 
        = \frac{1}{9} \begin{pmatrix} 1 & 2 \end{pmatrix} A_{mn} \begin{pmatrix} 2 \\ 1 \end{pmatrix}
    \end{equation}

    Получим
    
    \begin{equation}
        B = \frac{1}{9} \begin{pmatrix}
            19 & 19 \\
            22 & 6
        \end{pmatrix}
    \end{equation}

    Теперь применим к этим частичным суммам умножение на $T$. (Теперь будет постоянен номер столбца)

    \begin{equation}
        \tilde{\alpha}_{12}^{21} = \tau_{1}^{m} \tau_{2}^{n} b_{m n} = 
        \begin{pmatrix} 2 & -1 \end{pmatrix} B_{mn} \begin{pmatrix} -1 \\ 2 \end{pmatrix} 
        = \frac{16}{3}
    \end{equation}

    \section{Вычисление свёрток}

    На повестке дня $\alpha^{ij}_{ki}, \alpha^{ij}_{kj}, \alpha^{ij}_{ij}, \alpha^{ij}_{ji}$.

    У $\alpha^{ij}_{ki}$ ($2\times 2$) вторая и третья координата 
    определяются первой и второй кординатой матрицы, а по первой и четвёртой координате берётся сумма по таким, 
    чтобы они совпадали.

    То есть фиксирован для элемента матрицы слой (и равен номеру строки матрицы), 
    а также фиксирован номер внутреннего столбца (и равен номеру столбца матрицы):

    \begin{equation}
        \alpha^{ij}_{ki} = \beta^{j}_{k} = \begin{pmatrix}
            -1 + 4 & 0 + 0 \\
            -3 + 6 & -2 + 2
        \end{pmatrix} = \begin{pmatrix}
            3 & 0 \\
            3 & 0
        \end{pmatrix}
    \end{equation}

    У $\alpha^{ij}_{kj}$ ($2\times 2$) первая и третья координата 
    определяются первой и второй кординатой матрицы, а по второй и четвёртой координате берётся сумма по таким, 
    чтобы они совпадали.

    \begin{equation}
        \alpha^{ij}_{kj} = \gamma^{i}_{k} = \begin{pmatrix}
            -1 - 1 & 0 + 0 \\
            5 + 6 & 1 + 2
        \end{pmatrix} = \begin{pmatrix}
            -2 & 0 \\
            11 & 3
        \end{pmatrix}
    \end{equation}

    Следующие два тензора можно посчитать используя первые два:

    \begin{equation}
        \alpha^{ij}_{ij} = \gamma^{k}_{k} = \tr \Gamma = -2 + 3 = 1
    \end{equation}

    \begin{equation}
        \alpha^{ij}_{ji} = \beta^{k}_{k} = \tr B = 3 + 0 = 3
    \end{equation}
    
\end{document}