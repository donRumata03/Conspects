\documentclass[12pt, a4paper]{article}
\input{../../../LatexGloves/latex_math_header.tex}

% \usepackage{geometry}
% \geometry{
%     a4paper,
%     left=30mm,
%     right=30mm,
%     top=30mm,
%     bottom=20mm
% }


\author{Латыпов Владимир Витальевич, \\ ИТМО КТ M3138, \Huge{\textit{\textbf{вариант 10}}}}
\title{Типовик по линейной алгебре «Канонический вид матрицы. Часть 2»}

\begin{document}
    \tit

    \section{Формулировка условия}

    \begin{statement}
        Условие можно найти здесь: \url{https://drive.google.com/file/d/19M3w84tZ1nYPQF2CHLARb3ID0w2Tka6w/view?usp=sharing}

        Data section:

        \begin{equation}
            F = \left(\begin{matrix}
                0 & -10 & 3 & -5 \\
                -4 & 12 & -6 & 4 \\
                4 & 20 & -4 & 10 \\
                12 & 0 & 6 & 4
            \end{matrix}\right)
        \end{equation}

        \begin{equation}
            G = \left(\begin{matrix}
                -22 & 20 & 4 & -36 \\
                22 & 4 & 10 & 12 \\
                5 & -19 & -9 & 24 \\
                27 & -13 & 3 & 34
            \end{matrix}\right)
        \end{equation}

        \begin{equation}
            P = \left(\begin{matrix}
                -4 & 6 & 3 & 3 \\
                3 & -6 & -3 & -2 \\
                -3 & 5 & 2 & 2 \\
                -6 & 11 & 6 & 4
            \end{matrix}\right)
        \end{equation}

        \begin{equation}
            Q = \left(\begin{matrix}
                -26 & -39 & 65 & 13 \\
                -18 & -27 & 45 & 9 \\
                -16 & -24 & 40 & 8 \\
                -26 & -39 & 65 & 13
            \end{matrix}\right)
        \end{equation}

        \begin{equation}
            V = \left(\begin{matrix}
                -5 & 8 & 4 & -10 \\
                5 & -7 & 8 & -5 \\
                0 & -4 & -7 & 4 \\
                2 & 8 & 4 & -17
            \end{matrix}\right)
        \end{equation}

        
        \begin{equation}
            W = \left(\begin{matrix}
                1 & 2 & -4 & -4 \\
                10 & -1 & 10 & 8 \\
                -2 & 2 & -1 & -4 \\
                4 & -4 & 10 & 11
            \end{matrix}\right)
        \end{equation}
    \end{statement}


    \section{Построение спектрального разложения диагонализируемой матрицы}

    План: строим проекторы в собственном базисе, потом переходим в канонический.
    (Всё это только для матриц F и G)

    \subsection{Матрица F}

    \begin{multline}
        P_2 = T_F \cdot {\mathcal{P}_2}_v \cdot T_F^{-1} = \\
        T_F \cdot \left(\begin{matrix}
            1 & 0 & 0 & 0 \\
            0 & 1 & 0 & 0 \\
            0 & 0 & 0 & 0 \\
            0 & 0 & 0 & 0
        \end{matrix}\right) \cdot T_F^-1 = \\
        \left(\begin{matrix}
            2 & 5 & \frac{-3}{2} & \frac{5}{2} \\
            2 & -4 & 3 & -2 \\
            -2 & -10 & 4 & -5 \\
            -6 & 0 & -3 & 0
        \end{matrix}\right)
    \end{multline}

    *** Прямо как у Маяковского… ***

    \begin{multline}
        P_4 = T_F \cdot {\mathcal{P}_4}_v \cdot T_F^{-1} = \\
        T_F \cdot \left(\begin{matrix}
            0 & 0 & 0 & 0 \\
            0 & 0 & 0 & 0 \\
            0 & 0 & 1 & 0 \\
            0 & 0 & 0 & 1
        \end{matrix}\right) \cdot T_F^-1 = \\
        \left(\begin{matrix}
            -1 & -5 & \frac{3}{2} & \frac{-5}{2} \\
            -2 & 5 & -3 & 2 \\
            2 & 10 & -3 & 5 \\
            6 & 0 & 3 & 1
        \end{matrix}\right)
    \end{multline}

    Проверим, что 
    \begin{equation}
        2 P_{2} + 4 P_{4} = F
    \end{equation}

    \url{https://matrixcalc.org/#%7B%7B2,5,-3/2,5/2%7D,%7B2,-4,3,-2%7D,%7B-2,-10,4,-5%7D,%7B-6,0,-3,0%7D%7D*2+%7B%7B-1,-5,3/2,-5/2%7D,%7B-2,5,-3,2%7D,%7B2,10,-3,5%7D,%7B6,0,3,1%7D%7D*4}


    \subsection{Матрица G}

    \begin{multline}
        P_{-6} = T_G \cdot {\mathcal{P}_{-6}}_v \cdot T_G^{-1} = \\
        T_G \cdot \left(\begin{matrix}
            1 & 0 & 0 & 0 \\
            0 & 0 & 0 & 0 \\
            0 & 0 & 0 & 0 \\
            0 & 0 & 0 & 0
        \end{matrix}\right) \cdot T_G^{-1} = \\
        \left(\begin{matrix}
            2 & -2 & -1 & 3 \\
            -2 & 2 & 1 & -3 \\
            0 & 0 & 0 & 0 \\
            -2 & 2 & 1 & -3
        \end{matrix}\right)
    \end{multline}

    \begin{multline}
        P_{-2} = T_G \cdot {\mathcal{P}_{-2}}_v \cdot T_G^{-1} = \\
         T_G \cdot \left(\begin{matrix}
            0 & 0 & 0 & 0 \\
            0 & 1 & 0 & 0 \\
            0 & 0 & 0 & 0 \\
            0 & 0 & 0 & 0
        \end{matrix}\right) \cdot T_G^{-1} = \\
        \left(\begin{matrix}
            0 & 1 & 1 & -1 \\
            0 & -3 & -3 & 3 \\
            0 & 2 & 2 & -2 \\
            0 & -2 & -2 & 2
        \end{matrix}\right)
    \end{multline}

    \begin{multline}
        P_{5} = T_G \cdot {\mathcal{P}_{5}}_v \cdot T_G^{-1} = \\
         T_G \cdot \left(\begin{matrix}
            0 & 0 & 0 & 0 \\
            0 & 0 & 0 & 0 \\
            0 & 0 & 1 & 0 \\
            0 & 0 & 0 & 0
        \end{matrix}\right) \cdot T_G^{-1} = \\
        \left(\begin{matrix}
            0 & 0 & 0 & 0 \\
            2 & 2 & 2 & 0 \\
            -1 & -1 & -1 & 0 \\
            1 & 1 & 1 & 0
        \end{matrix}\right)
    \end{multline}


    \begin{multline}
        P_{10} = T_G \cdot {\mathcal{P}_{10}}_v \cdot T_G^{-1} = \\
         T_G \cdot \left(\begin{matrix}
            0 & 0 & 0 & 0 \\
            0 & 0 & 0 & 0 \\
            0 & 0 & 0 & 0 \\
            0 & 0 & 0 & 1
        \end{matrix}\right) \cdot T_G^{-1} = \\
        \left(\begin{matrix}
            -1 & 1 & 0 & -2 \\
            0 & 0 & 0 & 0 \\
            1 & -1 & 0 & 2 \\
            1 & -1 & 0 & 2
        \end{matrix}\right)
    \end{multline}

    Кто бы мог подумать, но 
    \begin{equation}
        -6 P_{-6} + -2 P_{-2} + 5 P_{5} + 10 P_{10} = G
    \end{equation}


    Не верите? Проверьте, вот ссылка!

    \url{https://matrixcalc.org/#%7B%7B2,-2,-1,3%7D,%7B-2,2,1,-3%7D,%7B0,0,0,0%7D,%7B-2,2,1,-3%7D%7D*(-6)+%7B%7B0,1,1,-1%7D,%7B0,-3,-3,3%7D,%7B0,2,2,-2%7D,%7B0,-2,-2,2%7D%7D*(-2)+%7B%7B0,0,0,0%7D,%7B2,2,2,0%7D,%7B-1,-1,-1,0%7D,%7B1,1,1,0%7D%7D*5+%7B%7B-1,1,0,-2%7D,%7B0,0,0,0%7D,%7B1,-1,0,2%7D,%7B1,-1,0,2%7D%7D*10}

    



    \section{Вычисление функции от диагонализируемой матрицы}

    Сделаем это для матриц $F$ и $G$ двумя способами:
    \begin{equation}
        f(t M) = \sum {f(t\lambda) P_\lambda} = T f(\mathfrak{L})
    \end{equation}

    \subsection{Экспонента}

    \begin{equation}
        e^{t F} = T_F \left(\begin{matrix}
            e^{2t} & 0 & 0 & 0 \\
            0 & e^{2t} & 0 & 0 \\
            0 & 0 & e^{4t} & 0 \\
            0 & 0 & 0 & e^{4t}
        \end{matrix}\right) T_F^-1 = 
        \left(\begin{matrix}
            -e^4+2*e^2 & -5*e^4+5*e^2 & \frac{3*e^4-3*e^2}{2} & \frac{-5*e^4+5*e^2}{2} \\
            -2*e^4+2*e^2 & 5*e^4-4*e^2 & -3*e^4+3*e^2 & 2*e^4-2*e^2 \\
            2*e^4-2*e^2 & 10*e^4-10*e^2 & -3*e^4+4*e^2 & 5*e^4-5*e^2 \\
            6*e^4-6*e^2 & 0 & 3*e^4-3*e^2 & e^4
        \end{matrix}\right)
    \end{equation}

    Посчитаем также через проекторы.

    \begin{multline}
        e^{t F} = e^{2t} P_2 + e^{4t} P_4 = \\
        e^2 \left(\begin{matrix}
            2 & 5 & \frac{-3}{2} & \frac{5}{2} \\
            2 & -4 & 3 & -2 \\
            -2 & -10 & 4 & -5 \\
            -6 & 0 & -3 & 0
        \end{matrix}\right) + e^4 \left(\begin{matrix}
            -1 & -5 & \frac{3}{2} & \frac{-5}{2} \\
            -2 & 5 & -3 & 2 \\
            2 & 10 & -3 & 5 \\
            6 & 0 & 3 & 1
        \end{matrix}\right) = \\
        \left(\begin{matrix}
            -e^4+2*e^2 & -5*e^4+5*e^2 & \frac{3*e^4-3*e^2}{2} & \frac{-5*e^4+5*e^2}{2} \\
            -2*e^4+2*e^2 & 5*e^4-4*e^2 & -3*e^4+3*e^2 & 2*e^4-2*e^2 \\
            2*e^4-2*e^2 & 10*e^4-10*e^2 & -3*e^4+4*e^2 & 5*e^4-5*e^2 \\
            6*e^4-6*e^2 & 0 & 3*e^4-3*e^2 & e^4
        \end{matrix}\right)
    \end{multline}

    Проверили, сошлось.

    То же самое для $G$.

    \begin{multline}
        e^{t G} = T_G \left(\begin{matrix}
            e^{-6} & 0 & 0 & 0 \\
            0 & e^{-2} & 0 & 0 \\
            0 & 0 & e^{5} & 0 \\
            0 & 0 & 0 & e^{10}
        \end{matrix}\right) T_G^-1 = \\ \left(\begin{matrix}
            \frac{-e^{16}+2}{e^6} & \frac{e^{16}+e^4-2}{e^6} & \frac{e^4-1}{e^6} & \frac{-2*e^{16}-e^4+3}{e^6} \\
            \frac{2*e^{11}-2}{e^6} & \frac{2*e^{11}-3*e^4+2}{e^6} & \frac{2*e^{11}-3*e^4+1}{e^6} & \frac{3*e^4-3}{e^6} \\
            e^{10}-e^5 & \frac{-e^{12}-e^7+2}{e^2} & \frac{-e^7+2}{e^2} & \frac{2*e^{12}-2}{e^2} \\
            \frac{e^{16}+e^{11}-2}{e^6} & \frac{-e^{16}+e^{11}-2*e^4+2}{e^6} & \frac{e^{11}-2*e^4+1}{e^6} & \frac{2*e^{16}+2*e^4-3}{e^6}
        \end{matrix}\right)
    \end{multline}

    Посчитаем также через проекторы.

    \begin{multline}
        e^{t G} = e^{-6t} P_{-6} + e^{-2t} P{-2} + e^{5t} P_{5} + e^{10t} P_{10} = \\
        e^{-6t} \left(\begin{matrix}
            2 & -2 & -1 & 3 \\
            -2 & 2 & 1 & -3 \\
            0 & 0 & 0 & 0 \\
            -2 & 2 & 1 & -3
        \end{matrix}\right) + e^{-2t} \left(\begin{matrix}
            0 & 1 & 1 & -1 \\
            0 & -3 & -3 & 3 \\
            0 & 2 & 2 & -2 \\
            0 & -2 & -2 & 2
        \end{matrix}\right) + \\
         e^{5t} \left(\begin{matrix}
            0 & 0 & 0 & 0 \\
            2 & 2 & 2 & 0 \\
            -1 & -1 & -1 & 0 \\
            1 & 1 & 1 & 0
        \end{matrix}\right) + e^{10t} \left(\begin{matrix}
            -1 & 1 & 0 & -2 \\
            0 & 0 & 0 & 0 \\
            1 & -1 & 0 & 2 \\
            1 & -1 & 0 & 2
        \end{matrix}\right) = \\ \left(\begin{matrix}
            \frac{-e^{16}+2}{e^6} & \frac{e^{16}+e^4-2}{e^6} & \frac{e^4-1}{e^6} & \frac{-2*e^{16}-e^4+3}{e^6} \\
            \frac{2*e^{11}-2}{e^6} & \frac{2*e^{11}-3*e^4+2}{e^6} & \frac{2*e^{11}-3*e^4+1}{e^6} & \frac{3*e^4-3}{e^6} \\
            e^{10}-e^5 & \frac{-e^{12}-e^7+2}{e^2} & \frac{-e^7+2}{e^2} & \frac{2*e^{12}-2}{e^2} \\
            \frac{e^{16}+e^{11}-2}{e^6} & \frac{-e^{16}+e^{11}-2*e^4+2}{e^6} & \frac{e^{11}-2*e^4+1}{e^6} & \frac{2*e^{16}+2*e^4-3}{e^6}
        \end{matrix}\right)
    \end{multline}

    Проверим, что результаты сошлись:
    \url{https://matrixcalc.org/#%7B%7B2,-2,-1,3%7D,%7B-2,2,1,-3%7D,%7B0,0,0,0%7D,%7B-2,2,1,-3%7D%7D*e%5E(-6*t)+%7B%7B0,1,1,-1%7D,%7B0,-3,-3,3%7D,%7B0,2,2,-2%7D,%7B0,-2,-2,2%7D%7D*e%5E(-2*t)+%7B%7B0,0,0,0%7D,%7B2,2,2,0%7D,%7B-1,-1,-1,0%7D,%7B1,1,1,0%7D%7D*e%5E(5*t)+%7B%7B-1,1,0,-2%7D,%7B0,0,0,0%7D,%7B1,-1,0,2%7D,%7B1,-1,0,2%7D%7D*e%5E(10*t)=%7B%7B(-e%5E(16*t)+2)/e%5E(6*t),(e%5E(16*t)+e%5E(4*t)-2)/e%5E(6*t),(e%5E(4*t)-1)/e%5E(6*t),(-2*e%5E(16*t)-e%5E(4*t)+3)/e%5E(6*t)%7D,%7B(2*e%5E(11*t)-2)/e%5E(6*t),(2*e%5E(11*t)-3*e%5E(4*t)+2)/e%5E(6*t),(2*e%5E(11*t)-3*e%5E(4*t)+1)/e%5E(6*t),(3*e%5E(4*t)-3)/e%5E(6*t)%7D,%7Be%5E(10*t)-e%5E(5*t),(-e%5E(12*t)-e%5E(7*t)+2)/e%5E(2*t),(-e%5E(7*t)+2)/e%5E(2*t),(2*e%5E(12*t)-2)/e%5E(2*t)%7D,%7B(e%5E(16*t)+e%5E(11*t)-2)/e%5E(6*t),(-e%5E(16*t)+e%5E(11*t)-2*e%5E(4*t)+2)/e%5E(6*t),(e%5E(11*t)-2*e%5E(4*t)+1)/e%5E(6*t),(2*e%5E(16*t)+2*e%5E(4*t)-3)/e%5E(6*t)%7D%7D}


    \subsection{Обращение}


    Очевидно, обе матрицы невырождены, так как в спектре нет нулей, обратим мы, конечно, $F$ — меньше возни.

    \begin{equation}
        F^{-1} = T_F \left(\begin{matrix}
            \frac12 & 0 & 0 & 0 \\
            0 & \frac12 & 0 & 0 \\
            0 & 0 & \frac14 & 0 \\
            0 & 0 & 0 & \frac14
        \end{matrix}\right) T_F^-1 = \left(\begin{matrix}
            \frac{3}{4} & \frac{5}{4} & \frac{-3}{8} & \frac{5}{8} \\
            \frac{1}{2} & \frac{-3}{4} & \frac{3}{4} & \frac{-1}{2} \\
            \frac{-1}{2} & \frac{-5}{2} & \frac{5}{4} & \frac{-5}{4} \\
            \frac{-3}{2} & 0 & \frac{-3}{4} & \frac{1}{4}
        \end{matrix}\right)
    \end{equation}
 
    А вот — с помощью проекторов:
    \begin{multline}
        F^{-1} = \frac12 P_{2} + \frac14 P_4 = \\
        \frac12 \left(\begin{matrix}
            2 & 5 & \frac{-3}{2} & \frac{5}{2} \\
            2 & -4 & 3 & -2 \\
            -2 & -10 & 4 & -5 \\
            -6 & 0 & -3 & 0
        \end{matrix}\right) + \frac14 \left(\begin{matrix}
            -1 & -5 & \frac{3}{2} & \frac{-5}{2} \\
            -2 & 5 & -3 & 2 \\
            6 & 0 & 3 & 1
            2 & 10 & -3 & 5 \\
        \end{matrix}\right) = \\ 
        \left(\begin{matrix}
            \frac{3}{4} & \frac{5}{4} & \frac{-3}{8} & \frac{5}{8} \\
            \frac{1}{2} & \frac{-3}{4} & \frac{3}{4} & \frac{-1}{2} \\
            \frac{-1}{2} & \frac{-5}{2} & \frac{5}{4} & \frac{-5}{4} \\
            \frac{-3}{2} & 0 & \frac{-3}{4} & \frac{1}{4}
        \end{matrix}\right)
    \end{multline}
 
    Калькулятор говорит нам, что

    \begin{multline}
        F F^-1 = \left(\begin{matrix}
            \frac{3}{4} & \frac{5}{4} & \frac{-3}{8} & \frac{5}{8} \\
            \frac{1}{2} & \frac{-3}{4} & \frac{3}{4} & \frac{-1}{2} \\
            \frac{-1}{2} & \frac{-5}{2} & \frac{5}{4} & \frac{-5}{4} \\
            \frac{-3}{2} & 0 & \frac{-3}{4} & \frac{1}{4}
        \end{matrix}\right) \left(\begin{matrix}
            0 & -10 & 3 & -5 \\
            -4 & 12 & -6 & 4 \\
            4 & 20 & -4 & 10 \\
            12 & 0 & 6 & 4
        \end{matrix}\right) = \\
        \left(\begin{matrix}
            \frac{3}{4}*0+\frac{5}{4}*\left(-4\right)+\frac{-3}{8}*4+\frac{5}{8}*12 & \frac{3}{4}*\left(-10\right)+\frac{5}{4}*12+\frac{-3}{8}*20+\frac{5}{8}*0 & \frac{3}{4}*3+\frac{5}{4}*\left(-6\right)+\frac{-3}{8}*\left(-4\right)+\frac{5}{8}*6 & \frac{3}{4}*\left(-5\right)+\frac{5}{4}*4+\frac{-3}{8}*10+\frac{5}{8}*4 \\
            \frac{1}{2}*0+\frac{-3}{4}*\left(-4\right)+\frac{3}{4}*4+\frac{-1}{2}*12 & \frac{1}{2}*\left(-10\right)+\frac{-3}{4}*12+\frac{3}{4}*20+\frac{-1}{2}*0 & \frac{1}{2}*3+\frac{-3}{4}*\left(-6\right)+\frac{3}{4}*\left(-4\right)+\frac{-1}{2}*6 & \frac{1}{2}*\left(-5\right)+\frac{-3}{4}*4+\frac{3}{4}*10+\frac{-1}{2}*4 \\
            \frac{-1}{2}*0+\frac{-5}{2}*\left(-4\right)+\frac{5}{4}*4+\frac{-5}{4}*12 & \frac{-1}{2}*\left(-10\right)+\frac{-5}{2}*12+\frac{5}{4}*20+\frac{-5}{4}*0 & \frac{-1}{2}*3+\frac{-5}{2}*\left(-6\right)+\frac{5}{4}*\left(-4\right)+\frac{-5}{4}*6 & \frac{-1}{2}*\left(-5\right)+\frac{-5}{2}*4+\frac{5}{4}*10+\frac{-5}{4}*4 \\
            \frac{-3}{2}*0+0*\left(-4\right)+\frac{-3}{4}*4+\frac{1}{4}*12 & \frac{-3}{2}*\left(-10\right)+0*12+\frac{-3}{4}*20+\frac{1}{4}*0 & \frac{-3}{2}*3+0*\left(-6\right)+\frac{-3}{4}*\left(-4\right)+\frac{1}{4}*6 & \frac{-3}{2}*\left(-5\right)+0*4+\frac{-3}{4}*10+\frac{1}{4}*4
        \end{matrix}\right) = \\
        \left(\begin{matrix}
            1 & 0 & 0 & 0 \\
            0 & 1 & 0 & 0 \\
            0 & 0 & 1 & 0 \\
            0 & 0 & 0 & 1
        \end{matrix}\right)
    \end{multline}

    А значит, ответ получился верным.

    \section{Построение минимального многочлена}

    Для каждой матрицы сначала построим минималные аннуоляторы
    векторов канонического базиса, попутно подддержживая НОК этих многочленов. 
    Если на каком-то шагу его стапень совпала с размерностью пространства, пришло время остановиться, 
    ведь минимальный многочлен всегда делит характеристический.

    Имея НОК всех аннуляторов, то есть $\phi(t)$, проверим, что его корни совпадают с корнями $\chi(t)$,
    причём должно быть $m(\lambda) \leqslant \alpha(\lambda)$.

    \subsection{Матрица F}

    Для начала найдём аннулятор вектора $\begin{pmatrix}
        1, 0, 0, 0
    \end{pmatrix}$.

    Рассмотрим $F^0x, Fx, F^2x, F^3x$

    Это будут: 
    \begin{equation}
        v_0, v_1, v_2, v_3 = \left(\begin{matrix}
            1\\0\\0\\0
        \end{matrix}\right), \left(\begin{matrix}
            0\\-4\\4 \\12
        \end{matrix}\right), \left(\begin{matrix}
            -8\\-24\\24\\72
        \end{matrix}\right), \left(\begin{matrix}
            -48\\-112\\112\\336
        \end{matrix}\right)
    \end{equation}

    Проверим, когда векторы станут зависимыми.
    Очевидно, что $v_0$ и $v_1$ независимы.
    Проверим, можно ли представить $v_3$ как $\alpha_1 v_1 + \alpha_2 v_2$?
    Чтобы ответить конкретно на этот вопрос, проверим ранг. Он оказался равен 2, так что представить можно, то есть решим систему:
    \begin{equation}
        \left(\begin{matrix}
            1 & 0  & \vrule&  -8 \\
            0 & -4 & \vrule  & -24\\
            0 & 4  & \vrule&  24 \\
            0 & 12 & \vrule  & 72
        \end{matrix}\right)
    \end{equation}

    \url{https://matrixcalc.org/slu.html#solve-using-Gaussian-elimination(%7B%7B1,0,-8%7D,%7B0,-4,-24%7D,%7B0,4,24%7D,%7B0,12,72%7D%7D)}

    Тогда $v_2 = -8 v_0 + 6v_1$. 
    Действительно: \url{https://www.wolframalpha.com/input?i=%7B-8%2C+0%2C+0%2C+0%7D+%2B+6+%7B+0%2C+-4%2C+4%2C+12+%7D}.

    Получим аннулятор этого элемента: $t^2 - 6t + 8 = (t - 2)(t - 4)$

    Далее, написав скрипт на Python с использованием numpy (для линейной алебры) и sympy (операции с многочленами в символьном виде, как wolfram alpha, только в python), проделаем то же самое.
    Оно для каждого базисного вектора матрицы сначала находит интересующией в линейной зависимости векторы ($A^k e_i$), потом для каждого префикса проверяет ранг, когда получилось — решает, 
    и поддерживает НОК (LCM) на данный момент.

    Запустим на матрице $F$:

    [1 0 0 0] [ 0 -4  4 12] [ -8 -24  24  72] \\
    Processed vector №1. Rank: 2\\
    Got this coefficients: [1, -6, 8]\\
    This polynom is: $\operatorname{Poly}{\left( t^{2} - 6 t + 8, t, domain=\mathbb{Z} \right)}$\\
    Current LCM is: $\operatorname{Poly}{\left( t^{2} - 6 t + 8, t, domain=\mathbb{Z} \right)}$\\
    Its degree is 2…
    
    [0 1 0 0] [-10  12  20   0] [-60  64 120   0] \\
    Processed vector №2. Rank: 2\\
    Got this coefficients: [1, -6, 8]\\
    This polynom is: $\operatorname{Poly}{\left( t^{2} - 6 t + 8, t, domain=\mathbb{Z} \right)}$\\
    Current LCM is: $\operatorname{Poly}{\left( t^{2} - 6 t + 8, t, domain=\mathbb{Z} \right)}$\\
    Its degree is 2…
    
    [0 0 1 0] [ 3 -6 -4  6] [ 18 -36 -32  36] \\
    Processed vector №3. Rank: 2\\
    Got this coefficients: [1, -6, 8]\\
    This polynom is: $\operatorname{Poly}{\left( t^{2} - 6 t + 8, t, domain=\mathbb{Z} \right)}$\\
    Current LCM is: $\operatorname{Poly}{\left( t^{2} - 6 t + 8, t, domain=\mathbb{Z} \right)}$\\
    Its degree is 2…
    
    [0 0 0 1] [-5  4 10  4] [-30  24  60  16] \\
    Processed vector №4. Rank: 2\\
    Got this coefficients: [1, -6, 8]\\
    This polynom is: $\operatorname{Poly}{\left( t^{2} - 6 t + 8, t, domain=\mathbb{Z} \right)}$\\
    Current LCM is: $\operatorname{Poly}{\left( t^{2} - 6 t + 8, t, domain=\mathbb{Z} \right)}$\\
    Its degree is 2…
    
    \begin{equation}\left( 1, \  \left[ \left( \operatorname{Poly}{\left( t - 4, t, domain=\mathbb{Z} \right)}, \  1\right), \  \left( \operatorname{Poly}{\left( t - 2, t, domain=\mathbb{Z} \right)}, \  1\right)\right]\right)\end{equation}
    
    То есть получим $\varphi(t) = (t - 2)(t - 4)$.
    Корни сошлись, замечательно. А также $m(\lambda) \leqslant \alpha(\lambda)$.



    \subsection{Матрица G}

    [1 0 0 0] [-22  22   5  27] [-28 -22  75  53] [-1432   682   875  1557] \\
    Processed vector №1. Rank: 3\\
    Got this coefficients: [1, -9, -40, 300]\\
    This polynom is: $\operatorname{Poly}{\left( t^{3} - 9 t^{2} - 40 t + 300, t, domain=\mathbb{Z} \right)}$\\
    Current LCM is: $\operatorname{Poly}{\left( t^{3} - 9 t^{2} - 40 t + 300, t, domain=\mathbb{Z} \right)}$\\
    Its degree is 3…
    
    [0 1 0 0] [ 20   4 -19 -13] [  32  110 -117  -11] [ 1424  -158 -1141 -1291] [  7424   3794 -10593  -6815] \\
    Processed vector №2. Rank: 4\\
    Got this coefficients: [1, -7, -58, 220, 600]\\
    This polynom is: $\operatorname{Poly}{\left( t^{4} - 7 t^{3} - 58 t^{2} + 220 t + 600, t, domain=\mathbb{Z} \right)}$\\
    Current LCM is: $\operatorname{Poly}{\left( t^{4} - 7 t^{3} - 58 t^{2} + 220 t + 600, t, domain=\mathbb{Z} \right)}$\\
    Its degree is 4 $\Rightarrow$ stop!
    
    \begin{multline}
        \biggg( 1, \  \biggg[ 
            \left( \operatorname{Poly}{\left( t - 10, t, domain=\mathbb{Z} \right)}, \  1\right), \\
            \left( \operatorname{Poly}{\left( t - 5, t, domain=\mathbb{Z} \right)}, \  1\right), \\
            \left( \operatorname{Poly}{\left( t + 2, t, domain=\mathbb{Z} \right)}, \  1\right), \\
            \left( \operatorname{Poly}{\left( t + 6, t, domain=\mathbb{Z} \right)}, \  1\right)
            \biggg]\biggg)
    \end{multline}
    
    То есть $\varphi(t) = (t + 6)(t + 2)(t - 5)(t- 10)$, всё сходится.

    \subsection{Матрица P}

    [1 0 0 0] [-4  3 -3 -6] [ 7 -9  9 15] [-10  18 -18 -27] \\
    Processed vector №1. Rank: 3\\
    Got this coefficients: [1, 3, 3, 1]\\
    This polynom is: $\operatorname{Poly}{\left( t^{3} + 3 t^{2} + 3 t + 1, t, domain=\mathbb{Z} \right)}$\\
    Current LCM is: $\operatorname{Poly}{\left( t^{3} + 3 t^{2} + 3 t + 1, t, domain=\mathbb{Z} \right)}$\\
    Its degree is 3…

    [0 1 0 0] [ 6 -6  5 11] [-12  17 -16 -28] [ 18 -34  33  51] \\
    Processed vector №2. Rank: 3\\
    Got this coefficients: [1, 3, 3, 1]\\
    This polynom is: $\operatorname{Poly}{\left( t^{3} + 3 t^{2} + 3 t + 1, t, domain=\mathbb{Z} \right)}$\\
    Current LCM is: $\operatorname{Poly}{\left( t^{3} + 3 t^{2} + 3 t + 1, t, domain=\mathbb{Z} \right)}$\\
    Its degree is 3…

    [0 0 1 0] [ 3 -3  2  6] [ -6   9  -8 -15] [  9 -18  17  27] \\
    Processed vector №3. Rank: 3\\
    Got this coefficients: [1, 3, 3, 1]\\
    This polynom is: $\operatorname{Poly}{\left( t^{3} + 3 t^{2} + 3 t + 1, t, domain=\mathbb{Z} \right)}$\\
    Current LCM is: $\operatorname{Poly}{\left( t^{3} + 3 t^{2} + 3 t + 1, t, domain=\mathbb{Z} \right)}$\\
    Its degree is 3…

    [0 0 0 1] [ 3 -2  2  4] [ -6   7  -7 -12] [  9 -15  15  23] \\
    Processed vector №4. Rank: 3\\
    Got this coefficients: [1, 3, 3, 1]\\
    This polynom is: $\operatorname{Poly}{\left( t^{3} + 3 t^{2} + 3 t + 1, t, domain=\mathbb{Z} \right)}$\\
    Current LCM is: $\operatorname{Poly}{\left( t^{3} + 3 t^{2} + 3 t + 1, t, domain=\mathbb{Z} \right)}$\\
    Its degree is 3…

    \begin{equation}\left( 1, \  \left[ \left( \operatorname{Poly}{\left( t + 1, t, domain=\mathbb{Z} \right)}, \  3\right)\right]\right)\end{equation}

    Видим, то у всех аннулятор одинаковый, и $\varphi(t) = (t + 1)^3$

    \subsection{Матрица Q}

    [1 0 0 0] [-26 -18 -16 -26] [0 0 0 0] \\
    Processed vector №1. Rank: 2\\
    Got this coefficients: [1, 0, 0]\\
    This polynom is: $\operatorname{Poly}{\left( t^{2}, t, domain=\mathbb{Z} \right)}$\\
    Current LCM is: $\operatorname{Poly}{\left( t^{2}, t, domain=\mathbb{Z} \right)}$\\
    Its degree is 2…

    [0 1 0 0] [-39 -27 -24 -39] [0 0 0 0] \\
    Processed vector №2. Rank: 2\\
    Got this coefficients: [1, 0, 0]\\
    This polynom is: $\operatorname{Poly}{\left( t^{2}, t, domain=\mathbb{Z} \right)}$\\
    Current LCM is: $\operatorname{Poly}{\left( t^{2}, t, domain=\mathbb{Z} \right)}$\\
    Its degree is 2…

    [0 0 1 0] [65 45 40 65] [0 0 0 0] \\
    Processed vector №3. Rank: 2\\
    Got this coefficients: [1, 0, 0]\\
    This polynom is: $\operatorname{Poly}{\left( t^{2}, t, domain=\mathbb{Z} \right)}$\\
    Current LCM is: $\operatorname{Poly}{\left( t^{2}, t, domain=\mathbb{Z} \right)}$\\
    Its degree is 2…

    [0 0 0 1] [13  9  8 13] [0 0 0 0] \\
    Processed vector №4. Rank: 2\\
    Got this coefficients: [1, 0, 0]\\
    This polynom is: $\operatorname{Poly}{\left( t^{2}, t, domain=\mathbb{Z} \right)}$\\
    Current LCM is: $\operatorname{Poly}{\left( t^{2}, t, domain=\mathbb{Z} \right)}$\\
    Its degree is 2…

    \begin{equation}\left( 1, \  \left[ \left( \operatorname{Poly}{\left( t, t, domain=\mathbb{Z} \right)}, \  2\right)\right]\right)\end{equation}

    То есть $\varphi(t) = t^2$

    \subsection{Матрица V}

    [1 0 0 0] [-5  5  0  2] [ 45 -70 -12  -4] [-793  639  348 -450] [14969 -3404 -6792 12568] \\
    Processed vector №1. Rank: 4\\
    Got this coefficients: [1, 36, 478, 2772, 5929]\\
    This polynom is: $\operatorname{Poly}{\left( t^{4} + 36 t^{3} + 478 t^{2} + 2772 t + 5929, t, domain=\mathbb{Z} \right)}$\\
    Current LCM is: $\operatorname{Poly}{\left( t^{4} + 36 t^{3} + 478 t^{2} + 2772 t + 5929, t, domain=\mathbb{Z} \right)}$\\
    Its degree is 4 $\Rightarrow$ stop!

    \begin{equation}\left( 1, \  \left[ \left( \operatorname{Poly}{\left( t + 7, t, domain=\mathbb{Z} \right)}, \  2\right), \  \left( \operatorname{Poly}{\left( t + 11, t, domain=\mathbb{Z} \right)}, \  2\right)\right]\right)\end{equation}

    Тут оказалось достаточно всего одного вектора. $\varphi(t) = (t + 7)^2(t + 11)^2$

    \subsection{Матрица W}

    [1 0 0 0] [ 1 10 -2  4] [ 13  12   4 -12] [ 69  62  42 -88] [ 377  344  296 -520] \\
    Processed vector №1. Rank: 4\\
    Got this coefficients: [1, -10, 28, -6, -45]\\
    This polynom is: $\operatorname{Poly}{\left( t^{4} - 10 t^{3} + 28 t^{2} - 6 t - 45, t, domain=\mathbb{Z} \right)}$\\
    Current LCM is: $\operatorname{Poly}{\left( t^{4} - 10 t^{3} + 28 t^{2} - 6 t - 45, t, domain=\mathbb{Z} \right)}$\\
    Its degree is 4 $\Rightarrow$ stop!

    \begin{equation}\left( 1, \  \left[ \left( \operatorname{Poly}{\left( t - 5, t, domain=\mathbb{Z} \right)}, \  1\right), \  \left( \operatorname{Poly}{\left( t + 1, t, domain=\mathbb{Z} \right)}, \  1\right), \  \left( \operatorname{Poly}{\left( t - 3, t, domain=\mathbb{Z} \right)}, \  2\right)\right]\right)\end{equation}

    Опять хватило одного. $\varphi(t) = (t - 5)(t + 1)(t - 3)^2$

\end{document}