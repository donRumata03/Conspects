\documentclass[12pt, a4paper]{article}
\input{../../../LatexGloves/latex_math_header.tex}

% \usepackage{geometry}
% \geometry{
%     a4paper,
%     left=30mm,
%     right=30mm,
%     top=30mm,
%     bottom=20mm
% }


\author{Латыпов Владимир Витальевич, \\ ИТМО КТ M3138, \Huge{\textit{\textbf{вариант 10}}}}
\title{Типовик по линейной алгебре «Линейные операторы в евклидовом пространстве»}

\begin{document}
    \tit

    \section{Формулировка условия}

    В пространстве многочленов степени не выше второй $P_{\leq 2}=\left\{p(t)=a_{0}+a_{1} t+a_{2} t^{2}\right\}$ 
    
    введено скалярное произведение по формуле: $(p, q)=\int_{a}^{b} p(t) q(t) \alpha(t) d t$, где $\alpha(t)-$ заданная весовая функция 
    
    и действует линейный дифференциальный оператор второго порядка $\mathcal{A}=k(t) \frac{d^{2}}{d t^{2}}+l(t) \frac{d}{d t}+m(t)$.
    
    \begin{tabular}{|c|c|c|c|c|c|c|}
    \hline$№$ & $a$ & $b$ & $\alpha(\mathbf{t})$ & $\mathbf{k}(\mathbf{t})$ & $\mathbf{l}(\mathbf{t})$ & $\mathbf{m}(\mathbf{t})$ \\
    \hline $\mathbf{1}$ & $-1$ & 1 & $|t|$ & $t$ & $-(t+5)$ & 3 \\
    \hline $\mathbf{2}$ & $-1$ & 1 & $1+t$ & $(t+1)^{2}$ & $-2(t+1)$ & 2 \\
    \hline $\mathbf{3}$ & $-1$ & 1 & $1-t$ & $t-1$ & $-(t+1)$ & 2 \\
    \hline $\mathbf{4}$ & $-1$ & 1 & $1-t$ & $t^{2}-3 t$ & $6-t^{2}$ & $2 t-6$ \\
    \hline $\mathbf{5}$ & $-1$ & 1 & $1-t^{2}$ & $t^{2}-1$ & 0 & $-6$ \\
    \hline $\mathbf{6}$ & $-1$ & 1 & 1 & $(2 t+1)^{2}$ & $-2(2 t+1)$ & 4 \\
    \hline $\mathbf{7}$ & $-1$ & 1 & $2-t$ & $(t-2)^{2}$ & $-3(t-2)$ & 4 \\
    \hline $\mathbf{8}$ & $-1$ & 1 & 1 & $2 t+1$ & $4 t-2$ & $-8$ \\
    \hline $\mathbf{9}$ & $-1$ & 1 & $|t|(1-t)$ & $t^{2}-t$ & $2 t-3$ & $-2$ \\
    \hline $\mathbf{1 0}$ & $-1$ & 1 & $1-t$ & $t-1$ & $-t$ & 1 \\
    \hline $\mathbf{1 1}$ & $-1$ & 1 & $1+t$ & $t$ & $-(t+1)$ & 1 \\
    \hline $\mathbf{1 2}$ & $-1$ & 1 & $1+t^{2}$ & 1 & $-2 t$ & 4 \\
    \hline $\mathbf{1 3}$ & $-1$ & 1 & $|t|$ & $t$ & $-(t+2)$ & 1 \\
    \hline $\mathbf{1 4}$ & $-1$ & 1 & $1-t^{2}$ & $1-t^{2}$ & $-2 t$ & 12 \\
    \hline $\mathbf{1 5}$ & $-1$ & 1 & $1-t$ & $t^{2}-1$ & $t-3$ & $-1$ \\
    \hline $\mathbf{1 6}$ & $-1$ & 1 & $1+t$ & $t$ & $-(2 t+1)$ & 2 \\
    \hline $\mathbf{1 7}$ & $-1$ & 1 & $3(1+t)$ & $2 t+1$ & $2 t-1$ & $-2$ \\
    \hline $\mathbf{1 8}$ & $-1$ & 1 & $|t|$ & $1-t^{2}$ & $-3 t$ & 0 \\
    \hline $\mathbf{1 9}$ & $-1$ & 1 & $1-t^{2}$ & $t^{2}-1$ & 0 & $-6$ \\
    \hline $\mathbf{2 0}$ & $-1$ & 1 & $3(1+t)$ & $2 t+1$ & $2 t-1$ & $-2$ \\
    \hline
    \end{tabular}
    
    \begin{enumerate}
        \item \begin{enumerate}
            \item Применяя процесс ортогонализации Грама - Шмидта к каноническому базису пространства $P_{\leq 2} e_{1}=1, e_{2}=t, e_{3}=t^{2}$ построить ортонормированный базис пространства $P_{\leq 2} e_{1}^{\prime}, e_{2}^{\prime}, e_{3}^{\prime}$.
            \item Построить матрицу Грама $\Gamma$ для канонического базиса пространства $P_{\leq 2} e_{1}=1$, $e_{2}=t, e_{3}=t^{2}$. Записать формулу для скалярного произведения в координатном представлении, где координаты многочленов записываются относительно канонического базиса $e$.            
            \item Используя матрицу Г и координатное представление многочленов $e_{1}^{\prime}, e_{2}^{\prime}, e_{3}^{\prime}$ в каноническом базисе пространства $P_{\leq 2}$ проверить ортонормированность полученного базиса.
            \item Выписать матрицу $\mathrm{T}=\mathrm{T}_{e \rightarrow e}$ перехода от базиса $e$ к базису $e^{\prime}$. Проверить формулу связи матриц Грама для базисов $e$ и $e^{\prime}$.
        \end{enumerate}
        \item \begin{enumerate}
            \item Найти матрицы $A$ и $A^{\prime}$ оператора $\mathcal{A}$ в базисах $e$ и $e^{\prime}$, соответственно, по определению матрицы оператора. Проверить полученные результаты, используя формулу связи матрицы оператора в разных базисах.
            \item Найти матрицу $A^{\circledast}$ оператора $\mathcal{A}^{*}$, сопряжённого к $\mathcal{A}$ в базисе $e$. 
            Найти матрицу оператора $\mathcal{A}^{*}$ в базисе $e^{\prime}$ двумя способами:
            \begin{itemize}
                \item по формуле матрицы сопряженного оператора
                \item используя формулу связи матрицы оператора $\mathcal{A}^{*}$ в разных базисах. 
            \end{itemize}
            \item Найти $\operatorname{Ker} A^{\circledast},(\operatorname{Im} A)^{\perp}$. Убедиться, что выполняется соотношение: $\operatorname{Ker}^{\circ}=(\operatorname{Im} A)^{\perp}$. Найти $\operatorname{Ker} \mathcal{A}^{*}$, выразив $K \operatorname{er} A^{\circledast}$ через элементы исходного пространства.        
        \end{enumerate}
        \item \begin{enumerate}
            \item Зная матрицу $A^{\circ}$ оператора $\mathcal{A}^{*}$ в базисе $e$ построить линейный дифференциальный оператор второго порядка, равный оператору $\mathcal{A}^{*}$.
            \item Проверить, что найденное в п.2.2 $\operatorname{Ker}_{\mathcal{A}^{*}}$, действительно, является ядром построенного дифференциального оператора $\mathcal{A}^{*}$ непосредственным применением $\mathcal{A}^{*}$ к базису $\operatorname{Ker}^{*} \mathcal{A}^{*}$.
            \item Для многочленов $p(t)=t^{2}+2$ и $q(t)=-t-1$ проверить непосредственной подстановкой что $(\mathcal{A} p, q)=\left(p, \mathcal{A}^{*} q\right)$.
        \end{enumerate}
        \item \begin{enumerate}
            \item 4.1. Ответить на вопросы. Является ли оператор $\mathcal{A}$ нормальным оператором? Является ли оператор $\mathcal{A}$ симметричным оператором? Является ли оператор $\mathcal{A}$ ортогональным оператором? Ответы обосновать.
            \item Можно ли в пространстве $P_{\leq 2}$ ввести скалярное произведение таким образом, чтобы в полученном евклидовом пространстве заданный оператор $\mathcal{A}$ был симметричным? Если можно, то получить формулу для его вычисления. Проверить, что при таком задании скалярного произведения в пространстве $P_{\leq 2}$, оператор будет симметричным $\mathcal{A}=\mathcal{A} *$.
        \end{enumerate}
    \end{enumerate}

    \section{Получение формул скалярного произведения и оператора}

    Вариант 10-й, поэтому:

    \begin{gather*}
        a = -1 \\
        b = 1 \\
        \alpha(t) = 1 - t \\
        k(t) = t - 1 \\
        l(t) = -t \\
        m(t) = 1
    \end{gather*}

    Начнём со скалярного произведения. 

    $] p(t) = p_3 t^2 + p_2 t + p_1, 
    q(t) = q_3 t^2 + q_2 t + q_1$

    \begin{equation}
        p \leftrightarrow \begin{pmatrix}
            p_1 \\ p_2 \\ p_3
        \end{pmatrix}, 
        q \leftrightarrow \begin{pmatrix}
            q_1 \\ q_2 \\ q_3
        \end{pmatrix}
    \end{equation}

    \begin{multline}
        \left\langle p, q \right\rangle = \\
        \int_{-1}^{1} (p_3 t^2 + p_2 t + p_1)(q_3 t^2 + q_2 t + q_1) (1 - t) \mathrm{d}t = \\
        2 p_1 q_1 - \frac 23 p_2 q_1 + \frac 23 p_3 q_1 - \frac 23 p_1 q_2 + \frac 23 p_2 q_2 
        - \frac 25 p_3 q_2 + \frac 23 p_1 q_3 - \frac 25 p_2 q_3 + \frac 25 p_3 q_3
    \end{multline}

    Получаем матрицу Грама:

    \begin{equation}
        \Gamma = \left(\begin{matrix}
            2 & \frac{-2}{3} & \frac{2}{3} \\
            \frac{-2}{3} & \frac{2}{3} & \frac{-2}{5} \\
            \frac{2}{3} & \frac{-2}{5} & \frac{2}{5}
        \end{matrix}\right)
    \end{equation}

    Теперь разберёмся с оператором.

    \begin{multline}
        \mathcal{A} (p_3 t^2 + p_2 t + p_1) = \\
        \left(k(t) \frac{\mathrm{d}^{2}}{\mathrm{d} t^{2}}+l(t) \frac{\mathrm{d}}{\mathrm{d} t}+m(t)\right)(p) = \\
        (t - 1) \frac{\mathrm{d}^{2}}{\mathrm{d} t^{2}}(p_3 t^2 + p_2 t + p_1) - t \frac{\mathrm{d}}{\mathrm{d} t} (p_3 t^2 + p_2 t + p_1) + 1 \cdot (p_3 t^2 + p_2 t + p_1) = \\
        -p_3 t^2 + 2 p_3 t + p_1 - 2 p_3 \\ \leftrightarrow \begin{pmatrix}
           p_1 - 2 p_3 \\
           2 p_3 \\
           - p_3
        \end{pmatrix}
    \end{multline}

    Замечаем, что это эндоморфизм на $P_{\leqslant 2}$.

    Тогда матрица $A$ оператора $\mathcal{A}$ в каноническом базисе $\{1, t, t^2\}$:

    \begin{equation}
        A = \begin{pmatrix}
            1 & 0 & -2 \\
            0 & 0 & 2 \\ 
            0 & 0 &  -1 \\
        \end{pmatrix}
    \end{equation}

    \section{Ортогонализация}

    \begin{equation}
        e_1'' = e_1 = \begin{pmatrix}
            1 \\ 0 \\0
        \end{pmatrix}
    \end{equation}

    \begin{multline}
        e_2'' \leadsto e_2 - \frac{\left\langle e_1'', e_2 \right\rangle}
        {\left\langle e_1'', e_1'' \right\rangle} e_1''=  \\
        e_2 - \frac{-\frac 23}{2} e_1'' = e_2 + \frac 13 e_1'' \\
        \leadsto 3 e_2 + e_1'' \leftrightarrow \begin{pmatrix}
            1 \\ 3 \\ 0
        \end{pmatrix}
    \end{multline}
    

    
    \begin{multline}
        e_3'' \leadsto e_3 - \frac{\left\langle e_1'', e_3 \right\rangle}
        {\left\langle e_1'', e_1'' \right\rangle} e_1''
        - \frac{\left\langle e_2'', e_3 \right\rangle}
        {\left\langle e_2'', e_2' \right\rangle} e_2'' = \\
        e_3 - \frac{\frac 23}{2} e_1''
        - \frac{-\frac 8 {15}}{4} e_2'' = e_3 - \frac 13 e_1''
        + \frac 2 {15} e_2'' \\
        \leadsto 15 e_3 - 5 e_1'' + 2 e_2'' \leftrightarrow \begin{pmatrix}
            -1 \\ 2 \\ 5
        \end{pmatrix}
    \end{multline}
    
    (Проверил на матричном калькуляторе — действителльно, 
    получилась система ортогональная для этой матрицы Грама и базис)

    Теперь вспомним, что нам нужна не просто 
    какая-то там $\{e_i''\}_{i = 1}^3$, а самая настоящая $\{e_i'\}_{i = 1}^3$!

    Поэтому заменим векторы на их орты 
    (важно, что скалярное произведение и, соответственно, норма 
    — не стандартные, а получаются через матрицу Грамма):

    \begin{equation}
        e_1' = \frac {1}{\sqrt{2}} \begin{pmatrix}
            1 \\ 0 \\ 0
        \end{pmatrix},
        e_2' = \frac{1}{2} \begin{pmatrix}
            1 \\ 3 \\ 0
        \end{pmatrix},
        e_3' = \frac{\sqrt{3}}{2\sqrt{2}} \begin{pmatrix}
            -1 \\ 2 \\ 5
        \end{pmatrix}
    \end{equation}

    Теперь получим матрицу перехода между базисами, 
    для этого просто запишем координаты нового базиса, которые мы получили.

    \begin{equation}
        T = E' = \left(\begin{matrix}
            \frac{1}{\sqrt{2}} & \frac{1}{2} & \frac{-\sqrt{3}}{2 \cdot \sqrt{2}} \\
            0 & \frac{3}{2} & \frac{2 \cdot \sqrt{3}}{2 \cdot \sqrt{2}} \\
            0 & 0 & \frac{5 \cdot \sqrt{3}}{2 \cdot \sqrt{2}}
        \end{matrix}\right)
    \end{equation}

    Можно посчитать матрицу Грамма для базиса $e'$. Это $E'^{T} \Gamma E'$.

    \begin{equation}
        G(e_1', e_2', e_3') = \left(\begin{matrix}
            1 & 0 & 0 \\
            0 & 1 & 0 \\
            0 & 0 & 1
        \end{matrix}\right)
    \end{equation}

    (как раз заметили, что оно ортонормированное)

    А что должно получаться по формуле из теории?

    \begin{equation}
        \Gamma' = T^{T} \Gamma T = G(e_1', e_2', e_3')
    \end{equation}

    Удивительно, но это одно и то же!

    Кстати, матрица $T$ в данном случае не ортогональна, так как канонический базис 
    не является ортогональным с данным скалярным произведением.



    \section{Матрица оператора $\mathcal{A}$}

    Найдём матрицы $A$ и $A^{\prime}$ оператора $\mathcal{A}$ 
    в базисах $e$ и $e^{\prime}$, соответственно, по определению матрицы оператора.

    Хм. Мы уже нашли матрицу $A$ оператора по определению (через действие на элементы базиса) 
    в самом начале.

    Далее план такой:
    \begin{enumerate}
        \item Найдём матрицу $A'$ по определению.
        \item Проверим через формулу связи матрицы оператора в разных базисах.
    \end{enumerate}

    Чтобы найти матрицу $A'$ по определению, 
    будем применять её к $e_i'$ в координатах канонического базиса, 
    а потом раскладывать по базису $\{ e_i' \}_{i = 1}^3$.

    Мы знаем про оператор $A$, как он действует на многочлен:
    \begin{equation}
        \mathcal{A}(p) = -2 p_3 t^2 - p_2 t + 2 p_3 t - 2 p_3 + 1 \leftrightarrow \begin{pmatrix}
            p_1 - 2 p_3 \\
            2 p_3 \\
            - p_3
         \end{pmatrix}
    \end{equation}

    Нужно сопоставить результатам действия оператора 
    на новые базисные векторы разложение по новому же базису.
    \begin{equation}
        \mathcal{A} e_i' \underset{e}{\longleftrightarrow} \ldots 
        \underset{e'}{\longleftrightarrow} \ldots
    \end{equation}

    Первое преобразование мы умеем делать, умножив координаты вектора
    в исходном базисе на матрицу $A$. 
    
    Со вторым сложнее — если делать «в лоб», 
    придётся представлять результат в виде линейной комбинации 
    многочленов, что делать не хочется.

    У нас линейная алгебра, поэтому мы знаем, как можно сделать это эффективно 
    (заметим, что мы всё ещё находим по определению).

    Для начала сопоставим матрицу из столбцов-разложений 
    действий вектора на элементы нового базиса в старом. 

    Для этого просто умножим матрицу $A$ на $E'$.

    \begin{equation}
        A E' = \left(\begin{matrix}
            \frac{\sqrt{2}}{2} & \frac{1}{2} & \frac{-11*\sqrt{6}}{4} \\
            0 & 0 & \frac{5*\sqrt{6}}{2} \\
            0 & 0 & \frac{-5*\sqrt{6}}{4}
        \end{matrix}\right)
    \end{equation}

    Теперь каждый столбец нужно разложить по базису $E'$. 
    А это легко сделать через матрицу сопряжённого базиса — достаточно слева умножить на неё,
    Матрица сопряжённого базиса равна обратной матрицы самого базиса.


    \begin{equation}
        A' = W (A E') = E'^{-1} A E' = \left(\begin{matrix}
            1 & \frac{\sqrt{2}}{2} & -8*\sqrt{3} \\
            0 & 0 & 2*\sqrt{6} \\
            0 & 0 & -1
        \end{matrix}\right)
    \end{equation}

    Теперь проверим через формулу для смены базиса матрицы оператора.
    Так как переходим из канонического базиса, матрица перехода $T_{e → e'} = E'$,
    То есть всё сошлось: $T_{e → e'} = E' \Rightarrow T^{-1} A T = E'^{-1} A E' = A'$.



    \section{Матрица сопряжённого оператора}

    Сначала — просто матрица $A^{\circledast}$ — в каноническом базисе. 
    (Забудем про сопряжения к.ч., у нас Евклидово)
    
    \begin{equation}
        A^{\circledast} = \Gamma^{-1} A^{*} \Gamma = \Gamma^{-1} A^T \Gamma = \left(\begin{matrix}
            \frac{27}{2} & \frac{-13}{2} & \frac{11}{2} \\
            \frac{-45}{2} & \frac{23}{2} & \frac{-19}{2} \\
            -60 & 30 & -25
        \end{matrix}\right)
    \end{equation}

    Теперь найдём матрицу сопряжённого оператора в новом (ОНБ) базисе.
    Найдём её двумя способами:

    \subsection{По формуле матрицы сопряжённого оператора}

    В базисе $e'$ у нас есть матрица Грама, да и $A'$ мы знаем, 
    так что — Что нам мешает найти аналогичным образом? 
    Вопрос риторический.

    (У нас должно получиться, что она = ${A^*}'$, так как ОНБ)

    \begin{equation}
        {A^{\circledast}}' = {\Gamma'}^{-1} {A^{*}}' \Gamma' 
        = E^{-1} {A'}^T E = {A'}^T = \left(\begin{matrix}
            1 & 0 & 0 \\
            \frac{\sqrt{2}}{2} & 0 & 0 \\
            -8*\sqrt{3} & 2*\sqrt{6} & -1
        \end{matrix}\right)
    \end{equation}

    \subsection{По формуле связи матрицы сопряжённого оператора в разных базисах}

    Однако можно проверить себя и получить то же, сменив базис у $A^{\circledast}_e$

    \begin{equation}
        {A^{\circledast}}' = T^{-1} A^{\circledast} T = \left(\begin{matrix}
            1 & 0 & 0 \\
            \frac{\sqrt{2}}{2} & 0 & 0 \\
            -8*\sqrt{3} & 2*\sqrt{6} & -1
        \end{matrix}\right)
    \end{equation}

    Сошлось.

    \section{Связь ядра сопряжённого оператора и образа исходного оператора}

    Для $\Ker A^{\circledast}$, как всегда, решаем СЛОУ с этой матрицей:

    \begin{equation}
        \Ker A^{\circledast} = \Span \left(\begin{matrix}
            \frac{-1}{6} \\
            \frac{1}{2} \\
            1
        \end{matrix}\right) = \Span \left(\begin{matrix}
            -1 \\
            3 \\
            6
        \end{matrix}\right)
    \end{equation}

    Теперь найдём образ $A$
    (образ оператора и ядро сопряжённого являются ортогональными дополнениями друг друга).

    Для нахождения ортгонального дополнения образа
    нужно решить систему, что скалярное произведение 
    с векторами-столбцами матрицы $A$ будет ноль.
    
    \begin{equation}
        A^T \Gamma x = \mathbb{0}
    \end{equation}

    \begin{equation}
        \Img \mathcal{A} = \Span \left(\begin{matrix}
            \frac{-1}{6} \\
            \frac{1}{2} \\
            1
        \end{matrix}\right) = \Span \left(\begin{matrix}
            -1 \\
            3 \\
            6
        \end{matrix}\right)
    \end{equation}

    То есть сошлось.

    \section{Венёмся к многочленам}

    У нас канонический базис из $\{1, t, t^2\}$, то есть для нахождения самих многочленов из $\Ker \mathcal{A}^{*}$
    в символьной форме достаточно записать линейные комбинации базиса ядра в виде многочленов. У нас только один параметр, назовём его $c$.

    \begin{equation}
        \Ker \mathcal{A}^{*} = \{ c(-1 + 3t + 6t^2) | c \in \sR \}
    \end{equation}


    \section{Построение дифференциального оператора второго порядка по матрице}

    Требуется представить оператор $\mathcal{B} = \mathcal{A}^*$ в виде:

    \begin{equation}
        \mathcal{B} = \alpha(t) \frac{d^{2}}{d t^{2}}+\beta(t) \frac{d}{d t}+\gamma(t)
    \end{equation}

    То есть нужно найти три многочлена-вектора.

    Давайте применим оператор $\mathcal{B}$ к векторам базиса.

    С одной стороны, получим это через матрицу:

    \begin{gather*}
        \mathcal{B} e_{1} = \frac{27}{2} e_{1} - \frac{45}{2} e_{2} - 60 e_{3} = \frac{27}{2} - \frac{45}{2} t - 60 t^2 \\
        \mathcal{B} e_{2} = -\frac{13}{2} e_{1} + \frac{23}{2} e_{2} + 30 e_{3} = -\frac{13}{2} + \frac{23}{2} t + 30 t^2 \\
        \mathcal{B} e_{3} = \frac{11}{2} e_{1} - \frac{19}{2} e_{2} - 25 e_{3} = \frac{11}{2} - \frac{19}{2} t - 25 t^2
    \end{gather*}

    Но из представления оператора через дифференциальный:

    \begin{gather*}
        \mathcal{B} e_{1}=\gamma(t) \\
        \mathcal{B} e_{2}=\beta(t)+\gamma(t) \cdot t \\
        \mathcal{B} e_{3}=\alpha(t) \cdot 2+\beta(t) \cdot 2 t+\gamma(t) \cdot t^{2}
    \end{gather*}    

    То есть задача свелась к решению системы уравнений.

    К счастью, система «треугольная», поэтому решим её в один проход:

    \begin{gather*}
        \gamma(t) = \frac{27}{2} - \frac{45}{2} t - 60 t^2 \\
        \beta(t) =  -\frac{13}{2} + \frac{23}{2} t + 30 t^2  - \gamma(t) \cdot t 
        = 60 t^3 + \frac{105}{2} t^2 -2t - \frac{13}{2} \\
        \alpha(t) = \frac{1}{2}\left(\frac{11}{2} - \frac{19}{2} t - 25 t^2 - 2t \beta(t) - t^{2} \gamma(t) \right) = \\
        \frac{1}{2}\left(\frac{11}{2} - \frac{19}{2} t - 25 t^2 + (-60 t^4 -\frac{165}{2} t^3 - \frac{19}{2} t^2 + 13t) \right) = \\
        -30 t^4 - \frac{165}{4} t^3 - \frac{69}{4} t^2 + \frac{7}{4} t + \frac{11}{4}
    \end{gather*}


    Итого представление $\mathcal{A}^*$ в виде дифференциального оператора:

    \begin{multline}
        \mathcal{A}^* = \left( -30 t^4 - \frac{165}{4} t^3 - \frac{69}{4} t^2 + \frac{7}{4} t + \frac{11}{4} \right) \frac{\mathrm{d}^{2}}{\mathrm{d} t^{2}} \\
        + \left(60 t^3 + \frac{105}{2} t^2 -2t - \frac{13}{2}\right) \frac{\mathrm{d}}{\mathrm{d} t} \\
        + \left( \frac{27}{2} - \frac{45}{2} t - 60 t^2 \right)
    \end{multline}

    Пункт 3.2: проверим, что не добавили в ядро лишнее, применив к базису ядра, выраженном в виде многочлена 
    наш оператор, который тоже выражен в формате многочленов.

    \begin{multline}
        A^* (c(-1 + 3t + 6t^2)) = 0 \Leftrightarrow A^* (-1 + 3t + 6t^2) = 0, A^* (-1 + 3t + 6t^2) = \\
        \left( -30 t^4 - \frac{165}{4} t^3 - \frac{69}{4} t^2 + \frac{7}{4} t + \frac{11}{4} \right) (12) \\
        + \left(60 t^3 + \frac{105}{2} t^2 -2t - \frac{13}{2}\right) (12 t + 3) \\
        + \left( \frac{27}{2} - \frac{45}{2} t - 60 t^2 \right) (-1 + 3t + 6t^2) = 0
    \end{multline}

    , как и требовалось.
    
    Пункт 3.3: Для многочленов $p(t)=t^{2}+2$ и $q(t)=-t-1$ проверим непосредственной подстановкой 
    что $\langle \mathcal{A} p, q \rangle =\left(p, \mathcal{A}^{*} q\right)$.

    Окей, мы знаем символьное представление обеих операторов, а также формулу для вычисления скалярного произведения (задана через определённый интеграл в условии),
    брать его для многосленов мы умеем.

    \begin{equation}
        \mathcal{A} p = -p_3 t^2 + 2 p_3 t + p_1 - 2 p_3 = \begin{bmatrix}
            p_1 = 2 \\ p_2 = 0 \\ p_3 = 1
        \end{bmatrix} = -t^2 + 2 t + 2 - 2 = -t^2 + 2 t
    \end{equation}

    Для $q$ можем найти через матрицу (знаем, какой многочлен сопоставляется, если известны коэффициенты исходного), 
    а можем через полученный дифференциальный оператор — и сверимся.

    \begin{equation}
        \mathcal{A}^* q = \begin{bmatrix}
            q_1 = -1 \\ p_2 = -1 \\ p_3 = 0
        \end{bmatrix} = \left(\begin{matrix}
            -7 \\
            11 \\
            30
        \end{matrix}\right) = 30 t^2 + 11t - 7
    \end{equation}

    \begin{multline}
        \mathcal{A}^* q = \mathcal{A}^* (-t - 1) = \\
        \left( -30 t^4 - \frac{165}{4} t^3 - \frac{69}{4} t^2 + \frac{7}{4} t + \frac{11}{4} \right) \cdot 0 \\
        + \left(60 t^3 + \frac{105}{2} t^2 -2t - \frac{13}{2}\right) \cdot (-1) \\
        + \left( \frac{27}{2} - \frac{45}{2} t - 60 t^2 \right) \cdot (-t - 1) = 30 t^2 + 11t - 7
    \end{multline}

    Действительно, сошлось.

    Теперь посчитаем скалярное произведение. Проше было бы через матрицу Грамма, но можно и:


    \begin{equation}
        \left\langle \mathcal{A} p, q \right\rangle =
        \int_{-1}^{1} (-t^2 + 2 t) (-t - 1) (1 - t) \mathrm{d}t = \frac{4}{15}
    \end{equation}


    \begin{equation}
        \left\langle p, \mathcal{A}^* q \right\rangle =
        \int_{-1}^{1} (t^{2}+2) (30 t^2 + 11t - 7) (1 - t) \mathrm{d}t = \frac{4}{15}
    \end{equation}

    Сошлось.


    \section{Нормальность, ортогональность, симметричность}

    В любом базисе проверим $AA^{\circledast} = A^{\circledast} A$, например, в $e$:

    \begin{multline}
        \left(\begin{matrix}
            \frac{27}{2} & \frac{-13}{2} & \frac{11}{2} \\
            \frac{-45}{2} & \frac{23}{2} & \frac{-19}{2} \\
            -60 & 30 & -25
        \end{matrix}\right) \left(\begin{matrix}
            1 & 0 & -2 \\
            0 & 0 & 2 \\
            0 & 0 & -1
        \end{matrix}\right) = \left(\begin{matrix}
            \frac{27}{2} & 0 & \frac{-91}{2} \\
            \frac{-45}{2} & 0 & \frac{155}{2} \\
            -60 & 0 & 205
        \end{matrix}\right) \neq \\
        \left(\begin{matrix}
            1 & 0 & -2 \\
            0 & 0 & 2 \\
            0 & 0 & -1
        \end{matrix}\right) \left(\begin{matrix}
            \frac{27}{2} & \frac{-13}{2} & \frac{11}{2} \\
            \frac{-45}{2} & \frac{23}{2} & \frac{-19}{2} \\
            -60 & 30 & -25
        \end{matrix}\right) = \left(\begin{matrix}
            \frac{267}{2} & \frac{-133}{2} & \frac{111}{2} \\
            -120 & 60 & -50 \\
            60 & -30 & 25
        \end{matrix}\right)
    \end{multline}

    То есть он ненормальный. То же самое можно заключить, заметив, что его собственные подпространства, (хотя он и ОПС, то есть базис из СВ есть),
    не ортогональны друг другу (с.ч. $0, 1, -1$).

    Таким образом, говорить об изометричности или самосопряжённости не приходится.
    (хотя там и собственные числа подходят под критерий самосопряжённости…)


    \section{Введение скалярного произведения для получения симметричности}

    Заметим, что ОПС-ность не зависит от скалярного произведения.
    $\mathcal{A}$ - действительно ОПС, его с.ч.: $0, 1, -1$. Собственные векторы (соответственно):

    \begin{equation}
        v_1 = \begin{pmatrix}
            0 \\ 1 \\ 0
        \end{pmatrix}, v_2 = \begin{pmatrix}
            1 \\ 0 \\ 0
        \end{pmatrix}, v_3 = \begin{pmatrix}
            1 \\ -2 \\ 1
        \end{pmatrix}
    \end{equation}

    Из теории известно, что  (Оператор самосопряжён) $\Leftrightarrow$ нормален + имеет вещественный спектр.

    Условие на с.ч. выполенено, а нормальность получим так: нужно, чтобы существовал ОНБ из с.в., 
    но у нас уже есть базис из с.в. Тогда введём скалярное произведение так, чтобы этот базис стал ОНБ.

    Итак, матрица Грама такого скалярного произведения в базисе $v = (v_1, v_2, v_3)$ — единична: $\Gamma_v = E$.

    Найдём её в базисе $e$:

    \begin{equation}
        E = \Gamma_v = T_{e → v}^T \Gamma_e T_{e → v}
    \end{equation}

    \begin{equation}
        \Gamma_e = (T_{e → v} T_{e → v}^T)^{-1} = \left(\begin{matrix}
            1 & 0 & -1 \\
            0 & 1 & 2 \\
            -1 & 2 & 6
        \end{matrix}\right)
    \end{equation}

    Формула в координатном представлении:

    \begin{equation}
        \langle x, y \rangle = x^T \Gamma_e y
    \end{equation}

    , если координаты — относительно базиса $e = \{ 1, t, t^2 \}$

    Проверим, что станет симметричным, для этого достаточно проверить, что в некотором базисе будет совпадать матрицы $A$ и $A^{\circledast}$.

    В $v$ уже проверили, но можем ещё проверить в $e$, чтобы понять, что с новой матрицей Грама не обманули:
    
    \begin{equation}
        A^{\circledast} = \Gamma_e^{-1} A^T \Gamma_e = \left(\begin{matrix}
            1 & 0 & -2 \\
            0 & 0 & 2 \\
            0 & 0 & -1
            \end{matrix}\right)
    \end{equation}

    Отлично, сошлось!

    % \section{Пример выполнения задания п. $3.1$.}
    
    % В пространстве $P_{\leq 2}$ со стандартным базисом $e_{1}=1, e_{2}=t, e_{3}=t^{2}$ линейный оператор задан матрицей $B=\left(\begin{array}{ccc}7 & 3 & 3 \\ -5 / 2 & 1 / 2 & 1 / 2 \\ -25 / 2 & -15 / 2 & -15 / 2\end{array}\right)$.
    
    % Построить соответствующий линейный дифференциальный оператор $\mathcal{B}=\alpha(t) \frac{d^{2}}{d t^{2}}+\beta(t) \frac{d}{d t}+\gamma(t) .$
    
    % \section{Решение.}
    
    % По определению матрицы оператора:
    
    % $\mathcal{B} e_{1}=7 e_{1}-\frac{5}{2} e_{2}-\frac{25}{2} e_{3}=7-\frac{5}{2} t-\frac{25}{2} t^{2}$
    
    % $B e_{2}=3 e_{1}+\frac{1}{2} e_{2}-\frac{15}{2} e_{3}=3+\frac{1}{2} t-\frac{15}{2} t^{2}$,
    
    % $B e_{3}=3 e_{1}+\frac{1}{2} e_{2}-\frac{15}{2} e_{3}=3+\frac{1}{2} t-\frac{15}{2} t^{2}$
    
    % С другой стороны, подействовав дифференциальным оператором $\mathcal{B}=\alpha(t) \frac{d^{2}}{d t^{2}}+$ $\beta(t) \frac{d}{d t}+\gamma(t)$ на базисные векторы получаем:
    
    % $\mathcal{B} e_{1}=\gamma(t)$,
    
    % $\mathcal{B} e_{2}=\beta(t)+\gamma(t) \cdot t$,
    
    % $\mathcal{B} e_{3}=\alpha(t) \cdot 2+\beta(t) \cdot 2 t+\gamma(t) \cdot t^{2} .$
    
    % Тогда, приравняв уравнения двух систем, получаем:
    
    % $\gamma(t)=7-\frac{5}{2} t-\frac{25}{2} t^{2}$
    
    % $\beta(t)+\gamma(t) \cdot t=3+\frac{1}{2} t-\frac{15}{2} t^{2}$
    
    % $\alpha(t) \cdot 2+\beta(t) \cdot 2 t+\gamma(t) \cdot t^{2}=3+\frac{1}{2} t-\frac{15}{2} t^{2} .$
    
    % Откуда:
    
    % $\gamma(t)=7-\frac{5}{2} t-\frac{25}{2} t^{2}$
    
    % $\beta(t)=3+\frac{1}{2} t-\frac{15}{2} t^{2}-\gamma(t) \cdot t=3-\frac{13}{2} t-5 t^{2}+\frac{25}{2} t^{3}$,
    
    % $\alpha(t)=\frac{1}{2}\left(3+\frac{1}{2} t-\frac{15}{2} t^{2}-\beta(t) \cdot 2 t-\gamma(t) \cdot t^{2}\right)=\frac{3}{2}-\frac{11}{4} t-\frac{3}{4} t^{2}+\frac{25}{4} t^{3}-\frac{25}{4} t^{4} .$
    
    % Таким образом,
    
    % $\mathcal{B}=\left(\frac{3}{2}-\frac{11}{4} t-\frac{3}{4} t^{2}+\frac{25}{4} t^{3}-\frac{25}{4} t^{4}\right) \frac{d^{2}}{d t^{2}}+\left(3-\frac{13}{2} t-5 t^{2}+\frac{25}{2} t^{3}\right) \frac{d}{d t}+\left(7-\frac{5}{2} t-\frac{25}{2} t^{2}\right) .$ 
    
        
    % \section{Алгоритм выполнения задания п.4.2.}
    
    % 1) Чтобы оператор $\mathcal{A}$ был симметричным в евклидовом пространстве, необходимо и достаточно, чтобы существовал базис пространства из о.н.с.в. Таким образом, оператор $\mathcal{A}$ необходимо (но не достаточно) должен быть о.п.с., т.е. его матрица в любом базисе диагонализируемой. Проверим диагонализируемость, например, для матрицы $A$ из п.2.1. 2) Пусть матрица $A$ из п.2.1 удовлетворяет необходимому условию, т.е. является диагонализируемой. Тогда $\mathbb{R}^{3}=\operatorname{spane}\left(v_{1}, v_{2}, v_{3}\right)$, где $v_{1}, v_{2}, v_{3}-$ собственные векторы матрицы $A$. Координаты векторов $v$ записаны относительно канонического базиса $e .$ Введем скалярное произведение таким образом, чтобы векторы $v_{1}, v_{2}, v_{3}$ стали бы о.н.б., т.е. матрица Грама для базиса $v \Gamma_{v}=\mathrm{E} .$ Пусть $\Gamma_{e}-$ матрица Грама канонического базиса $e$ в новом искомом скалярном произведении. Выпишем формулу связи матриц Грама базисов $е$ и $v \mathrm{~T}_{e \rightarrow v}^{\mathrm{T}} \Gamma_{e} \mathrm{~T}_{e \rightarrow v}=\Gamma_{v}=\mathrm{E}$, где $\mathrm{T}_{e \rightarrow v}=\left(v_{1}, v_{2}, v_{3}\right)$.
    
    % Откуда получаем, что искомое скалярное произведение определяется матрицей Грама $\Gamma_{e}=\left(\mathrm{T}_{e \rightarrow v} \mathrm{~T}_{e \rightarrow v}^{\mathrm{T}}\right)^{-1} .$ Выпишем формулу для скалярного произведения в координатном представлении $(x, y)=x^{\mathrm{T}} \Gamma_{e} y$, где координаты $x, y$ записываются относительно канонического базиса $e$.
    
    % 3) Проверим, что в евклидовом пространстве, порожденным скалярным произведением с матрицей Грама $\Gamma_{e}$, оператор $\mathcal{A}$ является симметричным. Найдём матрицу $A^{\circledast}$ оператора $\mathcal{A}^{*}$ в базисе $e$ и убедимся, что $A^{\circledast}=A$.
\end{document}


