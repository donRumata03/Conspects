\documentclass[12pt, a4paper]{article}
\input{../../LatexGloves/latex_math_header.tex}

% \usepackage{geometry}
% \geometry{
%     a4paper,
%     left=30mm,
%     right=30mm,
%     top=30mm,
%     bottom=20mm
% }


\author{Латыпов Владимир Витальевич, \\ ИТМО КТ M3138, \Huge{\textit{\textbf{вариант 12}}}}
\title{Типовик по линейной алгебре модуль 1: Задание 7 «Каноническая форма кривых второго порядка»}

\begin{document}
    \tittoc

    \section{Формулировка условия}

    \begin{statement}
        Условие таково: 
        
        Выполнив последовательно преобразования координат: поворот, а
        затем параллельный перенос координатных осей, преобразовать к
        каноническому виду уравнение кривой второго порядка и построить ее в
        канонической и исходной системе координат, а также найти параметры
        кривой.

        12. $7\sqrt{5} x^2 + \sqrt{5}y^2 + 8\sqrt{5}xy + 72x + 36y + 27\sqrt{5} = 0$
    \end{statement}

    \section{Решение}


    \subsection{Поворот системы координат}
    
    Для начала найдём такой поворот, чтобы член $x'y'$ исчез.
    \begin{equation}
        \begin{cases}
            x = cos(\alpha) x' - sin(\alpha) y' \\
            y = sin(\alpha) x' + cos(\alpha) y'
        \end{cases}
    \end{equation}

    Тогда уравение превращается в:
    \begin{multline}
        7\sqrt{5} (cos(\alpha) x' - sin(\alpha) y')^2 \\
        + \sqrt{5}(sin(\alpha) x' + cos(\alpha) y')^2 \\
        + 8\sqrt{5}(cos(\alpha) x' - sin(\alpha) y')(sin(\alpha) x' + cos(\alpha) y') \\
        + 72 (cos(\alpha) x' - sin(\alpha) y') \\
        + 36 (sin(\alpha) x' + cos(\alpha) y') \\
        + 27\sqrt{5}
    \end{multline}

    После expansion получается:
    \begin{multline}
        7 \sqrt{5} x'^2\cos^2\left(α\right) \\
        + \sqrt{5}x'^2\sin^2\left(α\right) \\
        + 8\sqrt{5}x'^2\cos \left(α\right)\sin \left(α\right) \\
        + 8\sqrt{5}x'y'\cos^2\left(α\right) \\
        - 8\sqrt{5}x'y'\sin ^2\left(α\right) \\
        - 12\sqrt{5}x'y'\sin \left(α\right)\cos \left(α\right) \\
        + 72x'\cos \left(α\right) \\
        + 36x'\sin \left(α\right) \\
        + 7\sqrt{5}y'^2\sin ^2\left(α\right) \\
        + \sqrt{5}y'^2\cos ^2\left(α\right) \\
        - 8\sqrt{5}y'^2\sin \left(α\right)\cos \left(α\right) \\
        - 72y'\sin \left(α\right) \\
        + 36y'\cos \left(α\right) \\
        + 27\sqrt{5}
    \end{multline}

    Выделяем члены с $x' y'$:
    \begin{equation}
        + 8\sqrt{5}x'y'\cos^2\left(α\right) \\
        - 8\sqrt{5}x'y'\sin ^2(α) \\
        - 12\sqrt{5}x'y'\sin (α) \cos(α)
    \end{equation}

    Тогда коэффициент перед $x'y'$ будет:
    \begin{multline}
        7\sqrt{5} \left( -2 cos(\alpha) sin(\alpha) \right) + 8\sqrt{5} \left( cos^2(\alpha) - sin^2(\alpha) \right) + \sqrt{5} \left( 2 cos(\alpha) sin(\alpha) \right) = \\
        \sqrt{5} ( cos(\alpha) sin(\alpha) (7 \cdot -2 + 2) + 8 cos^2(\alpha) - 8 sin^2(\alpha) )
    \end{multline}

    Этот коэффициент должен быть равен нулю. Тогда:
    \begin{gather}
        -12 cos(\alpha) sin(\alpha) + 8cos^2(\alpha) - 8sin^2(\alpha) = 0 \\
        -12tg(\alpha) + 8 - 8tg^2(\alpha) = 0 \\
        4\xi^2 + 6\xi - 4 = 0 \\
        \xi_{1, 2} = \{ -2, \frac{1}{2} \}
    \end{gather}

    Для любого $\alpha$ с одним из этих тангенсов (таких $\alpha$ всего 4) исчезнет перекрёсный член в новой системе координат.

    Возьмём, например, $tg(\alpha) = \frac{1}{2}$ и $\alpha \in (0, \frac{\pi}{2})$.
    Будет $\alpha = arctg\left( \frac{1}{2} \right)$
    Тогда $sin, cos > 0$
    \begin{gather}
        sin(\alpha) = \frac{tg(\alpha)}{\sqrt{1 + tg^2(\alpha)}} = \frac{1}{2} \frac{1}{\sqrt{\frac{5}{4}}} = \frac{1}{\sqrt{5}} = \frac{\sqrt{5}}{5} \\
        cos(\alpha) = \frac{1}{\sqrt{1 + tg^2(\alpha)}} = \frac{1}{\sqrt{\frac{5}{4}}} = \frac{2}{\sqrt{5}} = \frac{2\sqrt{5}}{5}
    \end{gather}

    Тогда старые координаты так выражаются через новые:
    \begin{equation}
        \begin{cases}
            x = \frac{2\sqrt{5}}{5} x' - \frac{\sqrt{5}}{5} y' \\
            y = \frac{\sqrt{5}}{5} x' + \frac{2\sqrt{5}}{5} y'
        \end{cases}
    \end{equation}

    И новая система коодинат будет выглядеть вот так относительно старой:

    \begin{figure}[h!]
        \centering
        \includegraphics[width=\textwidth]{resources/1.7_grid_x'.png}
        \caption{Система координат $(X', Y')$ относительно исходной}
        \label{fig:grid_1}
    \end{figure}
    \FloatBarrier
    

    Тогда перепишем уравнение в новой системе коодинат:
    \begin{multline}
        7\sqrt{5} \left(\frac{2\sqrt{5}}{5} x' - \frac{\sqrt{5}}{5} y'\right)^2 + \\
        \sqrt{5} \left(\frac{\sqrt{5}}{5} x' + \frac{2\sqrt{5}}{5} y'\right)^2 + \\
        8\sqrt{5} \left(\frac{2\sqrt{5}}{5} x' - \frac{\sqrt{5}}{5} y'\right)\left(\frac{\sqrt{5}}{5} x' + \frac{2\sqrt{5}}{5} y'\right) + \\
        72 \left(\frac{2\sqrt{5}}{5} x' - \frac{\sqrt{5}}{5} y'\right) + \\
        36 \left(\frac{\sqrt{5}}{5} x' + \frac{2\sqrt{5}}{5} y' \right) + \\
        27\sqrt{5} \\
        = 0
    \end{multline}

    \begin{multline}
        \frac{28 x'^2}{\sqrt{5}} - \frac{28 x' y'}{\sqrt{5}} + \frac{7 y'^2}{\sqrt{5}} + \\
        \frac{x'^2}{\sqrt{5}} + \frac{4 x' y'}{\sqrt{5}} + \frac{4 y'^2}{\sqrt{5}} + \\
        \frac{16 x'^2}{\sqrt{5}} + \frac{24 x' y'}{\sqrt{5}} - \frac{16 y'^2}{\sqrt{5}} + \\
        \frac{144 x'}{\sqrt{5}} - \frac{72 y'}{\sqrt{5}} + \\
        \frac{36 x'}{\sqrt{5}} + \frac{72 y'}{\sqrt{5}} + \\
        27\sqrt{5} \\
        = 0
    \end{multline}

    Получили:
    \begin{equation}
        9x'^2 + 36'x - y'^2 + 27 = 0
    \end{equation}

    \subsection{Параллельный перенос}

    Выделим полные квадраты:
    \begin{equation}
        9x'^2 + 36x' - y'^2 + 27 = 9(x'^2 + 4x' + 4) - y'^2 - 9 = 9(x' + 2)^2 - y'^2 - 9 = 0
    \end{equation}
    
    Назовём, получив выражение координат системы $(X', Y')$ через $(X'', Y'')$ и наоборот:
    \begin{equation}
        \begin{cases}
            x'' = x' + 2 \\
            y'' = y'
        \end{cases} \\
        \begin{cases}
            x' = x'' - 2 \\
            y' = y''
        \end{cases}
    \end{equation}
    
    \begin{figure}[h!]
        \centering
        \includegraphics[width=\textwidth]{resources/1.7_grid_x'.png}
        \caption{Система координат $(O'', X'', Y'')$ относительно СК $(O', X', Y')$}
        \label{fig:grid_2}
    \end{figure}
    \FloatBarrier

    \section{Малювание в системе координат два штриха}

    Тогда уравнение в системе координат «два штриха» будет таким:
    
    \begin{equation}
        9x''^2 - y'^2 = 9
    \end{equation}

    \begin{equation}
        \frac{x''^2}{1^2} - \frac{y'^2}{3^2} = 1
    \end{equation}

    То есть это гипербола, главная полуось: $a = 1$, 
    мнимая полуось: $b = 3$,
    $c = \sqrt{a^2 + b^2} = \sqrt{1 + 9} = \sqrt{10}$.
    Ещё параметры гиперболы:

    \begin{gather}
        \varepsilon = \frac{c}{a} = \frac{\sqrt{10}}{1} = \sqrt{10} \\
        F_l, F_r = (\mp c; 0) = (\mp \sqrt{10}; 0) \\
        V_l, V_r = (\mp a; 0)
        D_l, D_r: x'' = \mp \frac{a}{\varepsilon} = \mp \frac{1}{\sqrt{10}} = \mp \frac{\sqrt{10}}{10}
    \end{gather}

    И выглядеть она будет:
    
    \begin{figure}[h!]
        \centering
        \includegraphics[width=\textwidth]{resources/1.7_grid_x'.png}
        \caption{Гипербола в системе координат $(O'', X'', Y'')$}
        \label{fig:grid_3}
    \end{figure}
    \FloatBarrier


    \section{Итоговое преобразование координат}

    Таким образом, координаты для системы «один штрих» будут выражаться как:
    \begin{equation}
        \begin{cases}
            x' = x'' - 2 \\
            y' = y''
        \end{cases}
    \end{equation}
    (То есть сдвиг влево относительно двух штрихов на 2)

    А для изначальной СК:
    \begin{gather}
        \begin{cases}
            x = cos(\alpha) x' - sin(\alpha) y' = cos(\alpha) (x'' - 2) - sin(\alpha) y'' = \frac{2 \sqrt{5}}{5} (x'' - 2) - \frac{\sqrt{5}}{5} y'' \\
            y = sin(\alpha) x' + cos(\alpha) y' = \frac{\sqrt{5}}{5} (x'' - 2) + \frac{2 \sqrt{5}}{5} y''
        \end{cases} \\
        \begin{cases}
            x = \frac{2 \sqrt{5}}{5} x'' - \frac{\sqrt{5}}{5} y'' - \frac{4 \sqrt{5}}{5} \\
            y = \frac{\sqrt{5}}{5} x'' + \frac{2 \sqrt{5}}{5} y'' - \frac{2 \sqrt{5}}{5}
        \end{cases}
    \end{gather}

    Пользуясь этим, мы можем найти координаты ключевых характеристических фигур нашей гиперболы.

    Во-первых — $O''$ в исходной СК: $\left( -\frac{4 \sqrt{5}}{5}; -\frac{2 \sqrt{5}}{5} \right) \approx (-1.8; -0.9)$.

    Далее — в расход идут вершины и фокусы. В новой системе:
    
    \begin{equation}
        V_1, V_2 =
            \left(
                \frac{2 \sqrt{5}}{5} \cdot (\mp 1) - \frac{4 \sqrt{5}}{5};
                \frac{\sqrt{5}}{5} \cdot (\mp 1) - \frac{2 \sqrt{5}}{5} 
            \right)
    \end{equation}

    \begin{equation}
        V_1, V_2 =
            \left(
                \frac{2 \sqrt{5}}{5} \cdot (\mp 1) - \frac{4 \sqrt{5}}{5};
                \frac{\sqrt{5}}{5} \cdot (\mp 1) - \frac{2 \sqrt{5}}{5} 
            \right)
    \end{equation}

    \begin{gather}
        V_1 \approx
            \left(
                -2.7; -1.3 
            \right) \\
        V_2 \approx
        \left(
            -0.9; -0.5
        \right)
    \end{gather}
     

    \begin{equation}
        F_1, F_2 =
            \left(
                \frac{2 \sqrt{5}}{5} \cdot (\mp \sqrt{10}) - \frac{4 \sqrt{5}}{5};
                \frac{\sqrt{5}}{5} \cdot (\mp \sqrt{10}) - \frac{2 \sqrt{5}}{5} 
            \right)
    \end{equation}

    \begin{gather}
        F_l \approx \left(
                -4.6; \,
                -2.3
            \right) \\
        F_r \approx \left(
            1.; \,
            .5
        \right)
    \end{gather}

    Выразим наоборот — новые координаты через старые.

    \begin{gather}
        \begin{cases}
            x = \frac{2 \sqrt{5}}{5} x'' - \frac{\sqrt{5}}{5} y'' - \frac{4 \sqrt{5}}{5} \\
            y = \frac{\sqrt{5}}{5} x'' + \frac{2 \sqrt{5}}{5} y'' - \frac{2 \sqrt{5}}{5}
        \end{cases} \\
        \begin{cases}
            x = \frac{2 \sqrt{5}}{5} x'' - \frac{\sqrt{5}}{5} y'' - \frac{4 \sqrt{5}}{5} \\
            2y = \frac{2\sqrt{5}}{5} x'' + \frac{4 \sqrt{5}}{5} y'' - \frac{4 \sqrt{5}}{5}
        \end{cases} \\
        \begin{cases}
            x - 2y = (- \frac{\sqrt{5}}{5} - \frac{4 \sqrt{5}}{5} ) y'' = -\frac{5\sqrt{5}}{5} y'' = -\sqrt{5} y'' \\
            2y = \frac{2\sqrt{5}}{5} x'' + \frac{4 \sqrt{5}}{5} y'' - \frac{4 \sqrt{5}}{5}
        \end{cases} \\
        \begin{cases}
            y'' = \frac{2y - x}{\sqrt{5}} = \frac{2 \sqrt{5}}{5} y - \frac{\sqrt{5}}{5} x \\
            x = \frac{2 \sqrt{5}}{5} x'' - \frac{\sqrt{5}}{5} (\frac{2 \sqrt{5}}{5} y - \frac{\sqrt{5}}{5} x) - \frac{4 \sqrt{5}}{5}
        \end{cases} \\
        \frac{2 \sqrt{5}}{5} x'' = x + \frac{\sqrt{5}}{5} \left(\frac{2 \sqrt{5}}{5} y - \frac{\sqrt{5}}{5} x \right) + \frac{4 \sqrt{5}}{5} \\
        \frac{2 \sqrt{5}}{5} x'' = x + \frac{2}{5} y - \frac{1}{5} x + \frac{4 \sqrt{5}}{5} = \frac{4}{5} x + \frac{2}{5} y + \frac{4 \sqrt{5}}{5} \\
        x'' = \frac{\sqrt{5}}{2} \left( \frac{4}{5} x + \frac{2}{5} y + \frac{4 \sqrt{5}}{5} \right) = \frac{2 \sqrt{5}}{5} x + \frac{\sqrt{5}}{5} y + 2 \\
        \begin{cases}
            x'' = \frac{2 \sqrt{5}}{10} x + \frac{\sqrt{5}}{5} y + 2 \\
            y'' = - \frac{\sqrt{5}}{5} x + \frac{2 \sqrt{5}}{5} y
        \end{cases}
    \end{gather}


    Теперь тяжёлая артилерия: оси координат.

    \begin{multline}
        O''Y'': x'' \equiv 0 \\
        \Longleftrightarrow \frac{2 \sqrt{5}}{5} x + \frac{\sqrt{5}}{5} y + 2 = 0 \\
        \Longleftrightarrow \frac{\sqrt{5}}{5} y = -2 -\frac{2 \sqrt{5}}{5} x \\
        \Longleftrightarrow y = -2\sqrt{5} -\frac{2 \sqrt{5} \times \sqrt{5} }{5} x = -2\sqrt{5} - 2x
    \end{multline}

    \begin{multline}
        O''X'': y'' \equiv 0 \\
        \Longleftrightarrow - \frac{\sqrt{5}}{5} x + \frac{2 \sqrt{5}}{5} y = 0 \\
        \Longleftrightarrow \frac{2 \sqrt{5}}{5} y = \frac{\sqrt{5}}{5} x \\
        \Longleftrightarrow y = \frac{\sqrt{5}}{5} \times \frac{\sqrt{5}}{2} x = \frac{1}{2} x
    \end{multline}


    И, наконец, директриссы:
    
    \begin{gather}
        D_l: x'' = -\frac{\sqrt{10}}{10} \\
        \frac{2 \sqrt{5}}{5} x + \frac{\sqrt{5}}{5} y + 2 = -\frac{\sqrt{10}}{10} \\
        y = -2 x - 2 \sqrt{5} - \frac{\sqrt{2}}{2}
    \end{gather}
    
    \begin{gather}
        D_r: x'' = +\frac{\sqrt{10}}{10} \\
        \frac{2 \sqrt{5}}{5} x + \frac{\sqrt{5}}{5} y + 2 = +\frac{\sqrt{10}}{10} \\
        y = -2 x - 2 \sqrt{5} + \frac{\sqrt{2}}{2}
    \end{gather}

    \section{Итоговая иллюстрация}
    
    Теперь мы можем изобразить гиперболу в исходой системе координат.
    \begin{figure}[h!]
        \centering
        \includegraphics[width=\textwidth]{resources/1.7_grid_left.png}
        \caption{Гипербола в системе координат $(O, X, Y)$}
        \label{fig:grid_4}
    \end{figure}
    \FloatBarrier 
    


\end{document}
